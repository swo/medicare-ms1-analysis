---
title: "Differences in Medicare years"
author: "Scott Olesen"
date: "2/13/2017"
output:
  pdf_document:
    fig_caption: yes
---

# Motivation

There is a clear trend in the Medicare Part D data: more claims are reported in 2012 compared with 2011, 2013, and 2014.

I expected that this trend could be explained by three things:

1. There are more people enrolled in 2012 compared to the other years.
2. Enrollees in 2012 were more likely to use Part D claims.
3. Enrollees using Part D claims were more likely to have a higher number of claims in 2012.

It is easy to rule out the first two possibilities. First, the number of beneficiaries in the data only increases with each year (10.3 million in 2011, 10.7 in 2012, 11.1 in 2013, and 11.2 in 2014). Thus, there are also more claims per capita in the 2012 data.

Second, the number of enrollees who had any antibiotic prescription claim was similar across years and only slightly higher in 2012 compared to other years. In 2011, 31% of beneficiaries in the data had at least one antibiotic claim associated with them. In 2012, 38%; in 2013, 34%; in 2014, 36%.

This leaves the possibility that beneficiaries had, on average, more claims associated with them in 2012 than in other years.

# Method

I examined beneficiaries that were enrolled in the program during 2011, 2012, and 2013. To take a smaller slice, I considered beneficiaries from a single state, Florida (although the results were comparable when examining other states). I also considered only a single drug, azithromycin (although the results were comparable when considering the consumption of other drugs or of all drugs together).

For each set of beneficiaries, each drug, and each pair of consecutive years (2011-2012 and 2012-2013), I plotted the distribution of differences in number of days of drugs claimed. For example, if you took the number of days of azithromycin prescriptions for all beneficiaries in 2011 and subtracted the number of days of prescriptions for all beneficiaries in 2012 (keeping only those beneficiaries present in the data in both years), how are those numbers distributed?

If the distribution is not centered around zero, then individual users were more likely to have more days of claims in one year than the others. To ensure that peaks at zero difference have a clear meaning, I excluded beneficiaries from the plots who had zero claims in the two years. Thus, a zero value means an equal, nonzero days of claims in the two years.

# Results

```{r load_data, cache=TRUE, echo=FALSE, message=FALSE}
summarize_year = function(year) {
  fn = sprintf('../bene-abx-%s.tsv', year)
  read_tsv(fn) %>%
    mutate(state=factor(state)) %>%
    select(bene, days, azithromycin, state) %>%
    rename(abx_days=days, azi_days=azithromycin)
}

dat11 = summarize_year('2011') %>% select(bene, days11=azi_days, state)
dat12 = summarize_year('2012') %>% select(bene, days12=azi_days)
dat13 = summarize_year('2013') %>% select(bene, days13=azi_days)

dat = dat11 %>%
  filter(state=='Florida') %>%
  left_join(dat12, by='bene') %>%
  left_join(dat13, by='bene') %>%
  mutate(diff11.12=days11-days12, diff12.13=days12-days13)
```

```{r figure1, fig.width=4, fig.height=3, echo=FALSE, warning=FALSE, message=FALSE, fig.cap='Differences in azithromycin consumption in 2011 and 2012'}
dat %>%
  filter(days11 > 0 | days12 > 0) %>%
  ggplot(aes(x=diff11.12)) +
  geom_histogram() +
  xlab('days in 2011 minus days in 2012') + ylab('number of beneficiaries') +
  scale_y_log10() +
  theme_minimal()
```

```{r figure2, fig.width=4, fig.height=3, echo=FALSE, warning=FALSE, message=FALSE, fig.cap='Differences in azithromycin consumption in 2012 and 2013'}
dat %>%
  filter(days12 > 0 | days13 > 0) %>%
  ggplot(aes(x=diff12.13)) +
  geom_histogram() +
  xlab('days in 2012 minus days in 2013') + ylab('number of beneficiaries') +
  scale_y_log10() +
  theme_minimal()
```

# Discussion

Comparing 2012 and 2013, the mode of the distribution is zero: the most common scenario was for a beneficiary to have claims for the same number of days of azithromycin in the two years. However, the distribution is skewed to the left: it is more likely for a beneficiary to have had claims for more days azithromycin in 2013 than in 2012.

The comparison between 2011 and 2012 is more confusing. It appears that not one beneficiary had claims for more days of azithromycin in 2011 than in 2012.